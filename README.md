# EasyKeyDublicatorRFID_OLED
Simple RFID (EM-Marie, Mifare Classic) and wired (Dallas, Cyfral, Metacom) key dublicator with arduino. Supports EM4305, T5577, Mifare Classic 1K, RW-1990.1 RW-1990.2 TM-01 TM2004 protocols. There are connections scheme in the project.

Изменения по сравнению с оригиналом:
- Добавлена поддержка модуля MFRC522 (ВНИМАНИЕ, НУЖНА МОДИФИКАЦИЯ МОДУЛЯ), что позволяет копировать ключи Mifare Classic 1K 13.56Mhz;
- Добавлена поддержка кнопок (СМОТРИТЕ СХЕМЫ). Теперь можно выбрать, что использовать: энкодер или кнопки. В версии с кнопками при долгом нажатии на кнопку BtnDown очищается EEPROM, на BtnOK ключ добавляется в EEPROM;
- Используется безбуферная библиотека работы с OLED для высвобождения ОЗУ под буфер для Mifare Classic 1K.

МОДИФИКАЦИЯ МОДУЛЯ RC522

Практически все встречающиеся модули с RC522 на aliexpress и других подобных интернет-площадках сделаны для работы по SPI. Однако, согласно datasheet'у (https://www.elecrow.com/download/MFRC522%20Datasheet.pdf), микросхема MFRC522 поддерживает работу также по I2C и UART. Чтобы переделать стандартный модуль с ali, необходимо сдуть микросхему, перерезать две дорожки и соединить другие. Подробно разобрано ЗДЕСЬ: https://forum.arduino.cc/t/rc522-rfid-rc522-switching-spi-to-uart-interface-or-i2c-possible/425741. Или купить готовый модуль с поддержкой I2C (https://aliexpress.ru/item/1005003032034560.html).

ПРИМЕЧАНИЕ: с первого раза может не получится, т.к. большая часть микросхем на ali, скорее всего, поддельные. У меня микросхема, установленная на плату, после переделки не заработала. Поэтому, была заказана отдельно сама микросхема (https://aliexpress.ru/item/4001231434155.html), с ней заработало. Можно также попробовать заказать у другого продавца.

После описанных выше манипуляций, проверьте I2C-сканером, появился ли ещё какой-нибудь адрес кроме адреса OLED-дисплея (0x3C). У меня он был 0x28. Если у вас он будет другой, то поменяйте #define I2C_READER на свой адрес.

НЕКОТОРЫЕ ОСОБЕННОСТИ РАБОТЫ С КЛЮЧАМИ Mifare Classic 1K:
- Если считать информацию с одного ключа и сразу записать её на другой, то перезаписываются ВСЕ сектора;
- Если считать информацию с одного ключа и сохранить в EEPROM, то сохранится только UID, т.е. при последующей записи перезапишется ТОЛЬКО UID;
- На дисплее отображаются первые 8 бит, т.е. UID и некоторая часть информации завода-изготовителя;
- Необходимы болванки с возможностью перезаписи UID;
- ПИТАНИЕ модуля RC522 3.3V! 

Необходимые детали для поддержки 13.56Mhz:
- Модуль RC522 Mini I2C (НЕ ТРЕБУЕТ МОДИФИКАЦИИ) https://aliexpress.ru/item/1005003032034560.html;
- Ключи с поддержкой изменения UID https://aliexpress.ru/item/4000308003273.html;
- Модуль RC522, рекомендую Mini, т.к. она меньше по размерам (НЕОБХОДИМА МОДИФИКАЦИЯ, см. далее) https://aliexpress.ru/item/33020296300.html;
- Микросхема MFRC522 https://aliexpress.ru/item/4001231434155.html.
